webpackJsonp([19],{"3V7F":function(e,t,n){n("Peub"),n("UPQU"),n("OILV"),n("L6VT"),n("jxF6")},L6VT:function(e,t,n){(function(e){function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();!function(o){o.gl=o.gl||{},gl.ProtectedBranchEdit=function(){function o(e){t(this,o),this.$wrap=e.$wrap,this.$allowedToMergeDropdown=this.$wrap.find(".js-allowed-to-merge"),this.$allowedToPushDropdown=this.$wrap.find(".js-allowed-to-push"),this.buildDropdowns()}return n(o,[{key:"buildDropdowns",value:function(){new gl.ProtectedBranchAccessDropdown({$dropdown:this.$allowedToMergeDropdown,data:gon.merge_access_levels,onSelect:this.onSelect.bind(this)}),new gl.ProtectedBranchAccessDropdown({$dropdown:this.$allowedToPushDropdown,data:gon.push_access_levels,onSelect:this.onSelect.bind(this)})}},{key:"onSelect",value:function(){var t=this,n=this.$wrap.find('input[name="'+this.$allowedToMergeDropdown.data("fieldName")+'"]'),o=this.$wrap.find('input[name="'+this.$allowedToPushDropdown.data("fieldName")+'"]');n.length&&o.length&&(this.$allowedToMergeDropdown.disable(),this.$allowedToPushDropdown.disable(),e.ajax({type:"POST",url:this.$wrap.data("url"),dataType:"json",data:{_method:"PATCH",protected_branch:{merge_access_levels_attributes:[{id:this.$allowedToMergeDropdown.data("access-level-id"),access_level:n.val()}],push_access_levels_attributes:[{id:this.$allowedToPushDropdown.data("access-level-id"),access_level:o.val()}]}},error:function(){e.scrollTo(0),new Flash("Failed to update branch!")}}).always(function(){t.$allowedToMergeDropdown.enable(),t.$allowedToPushDropdown.enable()}))}}]),o}()}(window)}).call(t,n("lwLq"))},OILV:function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=function(){function e(t){n(this,e),this.onSelect=t.onSelect,this.$dropdown=t.$dropdown,this.$dropdownContainer=this.$dropdown.parent(),this.$dropdownFooter=this.$dropdownContainer.find(".dropdown-footer"),this.$protectedBranch=this.$dropdownContainer.find(".js-create-new-protected-branch"),this.buildDropdown(),this.bindEvents(),this.$dropdownFooter.addClass("hidden")}return o(e,[{key:"buildDropdown",value:function(){var e=this;this.$dropdown.glDropdown({data:this.getProtectedBranches.bind(this),filterable:!0,remote:!1,search:{fields:["title"]},selectable:!0,toggleLabel:function(e){return e&&"id"in e?e.title:"Protected Branch"},fieldName:"protected_branch[name]",text:function(e){return _.escape(e.title)},id:function(e){return _.escape(e.id)},onFilter:this.toggleCreateNewButton.bind(this),clicked:function(t,n,o){o.preventDefault(),e.onSelect()}})}},{key:"bindEvents",value:function(){this.$protectedBranch.on("click",this.onClickCreateWildcard.bind(this))}},{key:"onClickCreateWildcard",value:function(e){e.preventDefault(),this.$dropdown.data("glDropdown").remote.execute(),this.$dropdown.data("glDropdown").selectRowAtIndex()}},{key:"getProtectedBranches",value:function(e,t){t(this.selectedBranch?gon.open_branches.concat(this.selectedBranch):gon.open_branches)}},{key:"toggleCreateNewButton",value:function(e){this.selectedBranch={title:e,id:e,text:e},e&&this.$dropdownContainer.find(".js-create-new-protected-branch code").text(e),this.$dropdownFooter.toggleClass("hidden",!e)}}]),e}();window.ProtectedBranchDropdown=a},Peub:function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e){e.gl=e.gl||{},gl.ProtectedBranchAccessDropdown=function(){function e(t){n(this,e);var o=t.$dropdown,a=t.data,r=t.onSelect;o.glDropdown({data:a,selectable:!0,inputId:o.data("input-id"),fieldName:o.data("field-name"),toggleLabel:function(e,t){return t.is(".is-active")?e.text:"Select"},clicked:function(e,t,n){n.preventDefault(),r()}})}return e}()}(window)},UPQU:function(e,t,n){(function(e){function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();!function(o){o.gl=o.gl||{},gl.ProtectedBranchCreate=function(){function o(){t(this,o),this.$wrap=this.$form=e("#new_protected_branch"),this.buildDropdowns()}return n(o,[{key:"buildDropdowns",value:function(){var e=this.$wrap.find(".js-allowed-to-merge"),t=this.$wrap.find(".js-allowed-to-push");this.onSelectCallback=this.onSelect.bind(this),new gl.ProtectedBranchAccessDropdown({$dropdown:e,data:gon.merge_access_levels,onSelect:this.onSelectCallback}),new gl.ProtectedBranchAccessDropdown({$dropdown:t,data:gon.push_access_levels,onSelect:this.onSelectCallback}),t.data("glDropdown").selectRowAtIndex(0),e.data("glDropdown").selectRowAtIndex(0),new ProtectedBranchDropdown({$dropdown:this.$wrap.find(".js-protected-branch-select"),onSelect:this.onSelectCallback})}},{key:"onSelect",value:function(){var e=this.$wrap.find('input[name="protected_branch[name]"]'),t=this.$wrap.find('input[name="protected_branch[merge_access_levels_attributes][0][access_level]"]'),n=this.$wrap.find('input[name="protected_branch[push_access_levels_attributes][0][access_level]"]');this.$form.find('input[type="submit"]').attr("disabled",!(e.val()&&t.length&&n.length))}}]),o}()}(window)}).call(t,n("lwLq"))},jxF6:function(e,t,n){(function(e){function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(n){n.gl=n.gl||{},gl.ProtectedBranchEditList=function(){function n(){t(this,n),this.$wrap=e(".protected-branches-list"),this.$wrap.find(".js-protected-branch-edit-form").each(function(t,n){new gl.ProtectedBranchEdit({$wrap:e(n)})})}return n}()}(window)}).call(t,n("lwLq"))}},["3V7F"]);
//# sourceMappingURL=protected_branches.fd808e43ba6d4ed167dd.bundle.js.map